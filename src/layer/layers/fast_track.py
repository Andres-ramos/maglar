from ..layer import Layer


class FastTrackLayer(Layer):
    def __init__(self, gis, layer_title, arcgis_storage_folder, color):
        super().__init__(gis, layer_title, arcgis_storage_folder, color)

    def generate_layer(self, gdf):
        f_gdf = gdf[gdf["_hay_algun"] == "Sí"]
        f_gdf = f_gdf.drop(
            columns=[
                "CreationDa",
                "Creator",
                "EditDate",
                "Editor",
                "tel_fono",
                "nombre_y_a",
                "correo_ele",
                "categoria",
                "si_es_cons",
                "pregunta_s",
                "_se_puede_",
                "si_es_una_",
                "si_es_una1",
                "si_es_un_1",
                "si_es_un_2",
                "_tuvo_prob",
                "si_tienes_",
                "a_ade_come",
                "comentario",
                "field_21_o",
                "_hay_algun",
            ]
        )
        f_gdf = f_gdf.rename(
            columns={
                "_qu_ves_ti": "¿Qué ves? Tipo de observación",
                "pueblo_en_": "Pueblo",
                "_hay_otras": "¿Hay otras observaciones aledañas al lugar?",
                "_se_pudo_o": "¿Qué otras observaciones viste?",
            }
        )

        return f_gdf.to_json()

    def generate_style(self):
        return {
            "renderer": {
                "type": "simple",
                "symbol": {
                    "type": "CIMSymbolReference",
                    "symbol": {
                        "type": "CIMPointSymbol",
                        "symbolLayers": [
                            {
                                "type": "CIMVectorMarker",
                                "enable": True,
                                "colorLocked": True,
                                "anchorPointUnits": "Relative",
                                "dominantSizeAxis3D": "Y",
                                "size": 7.5,
                                "billboardMode3D": "FaceNearPlane",
                                "frame": {"xmin": 0, "ymin": 0, "xmax": 32, "ymax": 32},
                                "markerGraphics": [
                                    {
                                        "type": "CIMMarkerGraphic",
                                        "geometry": {
                                            "rings": [
                                                [
                                                    [16, 0.9],
                                                    [17.4, 1],
                                                    [18, 1],
                                                    [18.7, 1.2],
                                                    [19.5, 1.3],
                                                    [20.2, 1.5],
                                                    [20.9, 1.7],
                                                    [21.6, 2],
                                                    [22.3, 2.3],
                                                    [22.9, 2.6],
                                                    [23.6, 3],
                                                    [24.3, 3.4],
                                                    [24.9, 3.8],
                                                    [25.5, 4.3],
                                                    [26.1, 4.8],
                                                    [26.7, 5.3],
                                                    [27.2, 5.9],
                                                    [27.7, 6.5],
                                                    [28.2, 7.1],
                                                    [28.6, 7.7],
                                                    [29, 8.4],
                                                    [29.4, 9.1],
                                                    [29.7, 9.7],
                                                    [30, 10.4],
                                                    [30.3, 11.1],
                                                    [30.5, 11.8],
                                                    [30.7, 12.5],
                                                    [30.8, 13.3],
                                                    [31, 14],
                                                    [31, 14.6],
                                                    [31.1, 15.3],
                                                    [31.1, 16],
                                                    [30.9, 18.4],
                                                    [30.4, 20.7],
                                                    [29.5, 22.9],
                                                    [28.2, 24.9],
                                                    [26.7, 26.7],
                                                    [24.9, 28.2],
                                                    [22.9, 29.5],
                                                    [20.7, 30.4],
                                                    [18.4, 30.9],
                                                    [16, 31.1],
                                                    [13.6, 30.9],
                                                    [11.3, 30.4],
                                                    [9.1, 29.5],
                                                    [7.1, 28.2],
                                                    [5.3, 26.7],
                                                    [3.8, 24.9],
                                                    [2.5, 22.9],
                                                    [1.6, 20.7],
                                                    [1.1, 18.4],
                                                    [0.9, 16],
                                                    [1.1, 13.6],
                                                    [1.6, 11.3],
                                                    [2.5, 9.1],
                                                    [3.8, 7.1],
                                                    [5.3, 5.3],
                                                    [7.1, 3.8],
                                                    [9.1, 2.5],
                                                    [11.3, 1.6],
                                                    [13.6, 1.1],
                                                    [16, 0.9],
                                                ]
                                            ]
                                        },
                                        "symbol": {
                                            "type": "CIMPolygonSymbol",
                                            "symbolLayers": [
                                                {
                                                    "type": "CIMSolidFill",
                                                    "enable": False,
                                                    "color": [0, 0, 0, 255],
                                                }
                                            ],
                                        },
                                    },
                                    {
                                        "type": "CIMMarkerGraphic",
                                        "geometry": {
                                            "rings": [
                                                [
                                                    [10, 16.9],
                                                    [10.36, 16.93],
                                                    [10.71, 17.03],
                                                    [11.04, 17.18],
                                                    [11.34, 17.39],
                                                    [11.6, 17.64],
                                                    [11.81, 17.94],
                                                    [11.96, 18.27],
                                                    [12.06, 18.62],
                                                    [12.1, 19],
                                                    [12.07, 19.36],
                                                    [11.97, 19.71],
                                                    [11.82, 20.04],
                                                    [11.61, 20.34],
                                                    [11.35, 20.6],
                                                    [11.06, 20.81],
                                                    [10.73, 20.96],
                                                    [10.38, 21.06],
                                                    [10, 21.1],
                                                    [9.64, 21.07],
                                                    [9.29, 20.97],
                                                    [8.96, 20.82],
                                                    [8.66, 20.61],
                                                    [8.4, 20.36],
                                                    [8.19, 20.06],
                                                    [8.04, 19.73],
                                                    [7.94, 19.38],
                                                    [7.9, 19],
                                                    [7.94, 18.59],
                                                    [8.06, 18.2],
                                                    [8.25, 17.83],
                                                    [8.52, 17.52],
                                                    [8.83, 17.25],
                                                    [9.2, 17.06],
                                                    [9.59, 16.94],
                                                    [10, 16.9],
                                                ]
                                            ]
                                        },
                                        "symbol": {
                                            "type": "CIMPolygonSymbol",
                                            "symbolLayers": [
                                                {
                                                    "type": "CIMSolidFill",
                                                    "enable": True,
                                                    "colorLocked": True,
                                                    "color": [255, 255, 255, 255],
                                                }
                                            ],
                                        },
                                    },
                                    {
                                        "type": "CIMMarkerGraphic",
                                        "geometry": {
                                            "rings": [
                                                [
                                                    [22, 16.9],
                                                    [22.36, 16.93],
                                                    [22.71, 17.03],
                                                    [23.04, 17.18],
                                                    [23.34, 17.39],
                                                    [23.6, 17.65],
                                                    [23.81, 17.94],
                                                    [23.96, 18.27],
                                                    [24.06, 18.62],
                                                    [24.1, 19],
                                                    [24.07, 19.36],
                                                    [23.97, 19.71],
                                                    [23.82, 20.04],
                                                    [23.61, 20.34],
                                                    [23.36, 20.6],
                                                    [23.06, 20.81],
                                                    [22.73, 20.96],
                                                    [22.38, 21.06],
                                                    [22, 21.1],
                                                    [21.64, 21.07],
                                                    [21.29, 20.97],
                                                    [20.96, 20.82],
                                                    [20.66, 20.61],
                                                    [20.4, 20.36],
                                                    [20.19, 20.06],
                                                    [20.04, 19.73],
                                                    [19.94, 19.38],
                                                    [19.9, 19],
                                                    [19.93, 18.64],
                                                    [20.03, 18.29],
                                                    [20.18, 17.96],
                                                    [20.39, 17.66],
                                                    [20.64, 17.4],
                                                    [20.94, 17.19],
                                                    [21.27, 17.04],
                                                    [21.62, 16.94],
                                                    [22, 16.9],
                                                ]
                                            ]
                                        },
                                        "symbol": {
                                            "type": "CIMPolygonSymbol",
                                            "symbolLayers": [
                                                {
                                                    "type": "CIMSolidFill",
                                                    "enable": True,
                                                    "colorLocked": True,
                                                    "color": [255, 255, 255, 255],
                                                }
                                            ],
                                        },
                                    },
                                    {
                                        "type": "CIMMarkerGraphic",
                                        "geometry": {
                                            "rings": [
                                                [
                                                    [8.24, 8.27],
                                                    [8.37, 8.16],
                                                    [8.51, 8.08],
                                                    [8.66, 8.02],
                                                    [8.82, 7.99],
                                                    [8.99, 7.98],
                                                    [9.15, 8],
                                                    [9.31, 8.05],
                                                    [9.46, 8.12],
                                                    [9.59, 8.21],
                                                    [9.71, 8.33],
                                                    [10.83, 9.27],
                                                    [12.08, 10.02],
                                                    [13.44, 10.55],
                                                    [14.87, 10.86],
                                                    [16.33, 10.92],
                                                    [17.78, 10.75],
                                                    [19.18, 10.34],
                                                    [20.49, 9.71],
                                                    [21.69, 8.87],
                                                    [22.28, 8.33],
                                                    [22.61, 8.09],
                                                    [23, 8],
                                                    [23.16, 8.01],
                                                    [23.31, 8.05],
                                                    [23.46, 8.1],
                                                    [23.59, 8.19],
                                                    [23.71, 8.29],
                                                    [23.82, 8.42],
                                                    [23.91, 8.57],
                                                    [23.97, 8.74],
                                                    [24, 8.91],
                                                    [24, 9.08],
                                                    [23.97, 9.25],
                                                    [23.91, 9.42],
                                                    [23.82, 9.57],
                                                    [23.71, 9.7],
                                                    [22.35, 10.86],
                                                    [20.81, 11.78],
                                                    [19.15, 12.44],
                                                    [17.39, 12.82],
                                                    [15.6, 12.91],
                                                    [13.83, 12.7],
                                                    [12.1, 12.2],
                                                    [10.49, 11.43],
                                                    [9.02, 10.4],
                                                    [8.3, 9.74],
                                                    [8.07, 9.46],
                                                    [7.96, 9.11],
                                                    [7.97, 8.75],
                                                    [8.12, 8.42],
                                                    [8.24, 8.27],
                                                ]
                                            ]
                                        },
                                        "symbol": {
                                            "type": "CIMPolygonSymbol",
                                            "symbolLayers": [
                                                {
                                                    "type": "CIMSolidFill",
                                                    "enable": True,
                                                    "colorLocked": True,
                                                    "color": [255, 255, 255, 255],
                                                }
                                            ],
                                        },
                                    },
                                ],
                                "scaleSymbolsProportionally": True,
                                "respectFrame": True,
                                "clippingPath": {
                                    "type": "CIMClippingPath",
                                    "clippingType": "Intersect",
                                    "path": {
                                        "rings": [
                                            [[0, 0], [32, 0], [32, 32], [0, 32], [0, 0]]
                                        ]
                                    },
                                },
                                "rotation": 360,
                            },
                            {
                                "type": "CIMVectorMarker",
                                "enable": True,
                                "anchorPointUnits": "Relative",
                                "dominantSizeAxis3D": "Y",
                                "size": 7.5,
                                "billboardMode3D": "FaceNearPlane",
                                "frame": {"xmin": 0, "ymin": 0, "xmax": 32, "ymax": 32},
                                "markerGraphics": [
                                    {
                                        "type": "CIMMarkerGraphic",
                                        "geometry": {
                                            "rings": [
                                                [
                                                    [16, 0.9],
                                                    [17.4, 1],
                                                    [18, 1],
                                                    [18.7, 1.2],
                                                    [19.5, 1.3],
                                                    [20.2, 1.5],
                                                    [20.9, 1.7],
                                                    [21.6, 2],
                                                    [22.3, 2.3],
                                                    [22.9, 2.6],
                                                    [23.6, 3],
                                                    [24.3, 3.4],
                                                    [24.9, 3.8],
                                                    [25.5, 4.3],
                                                    [26.1, 4.8],
                                                    [26.7, 5.3],
                                                    [27.2, 5.9],
                                                    [27.7, 6.5],
                                                    [28.2, 7.1],
                                                    [28.6, 7.7],
                                                    [29, 8.4],
                                                    [29.4, 9.1],
                                                    [29.7, 9.7],
                                                    [30, 10.4],
                                                    [30.3, 11.1],
                                                    [30.5, 11.8],
                                                    [30.7, 12.5],
                                                    [30.8, 13.3],
                                                    [31, 14],
                                                    [31, 14.6],
                                                    [31.1, 15.3],
                                                    [31.1, 16],
                                                    [30.9, 18.4],
                                                    [30.4, 20.7],
                                                    [29.5, 22.9],
                                                    [28.2, 24.9],
                                                    [26.7, 26.7],
                                                    [24.9, 28.2],
                                                    [22.9, 29.5],
                                                    [20.7, 30.4],
                                                    [18.4, 30.9],
                                                    [16, 31.1],
                                                    [13.6, 30.9],
                                                    [11.3, 30.4],
                                                    [9.1, 29.5],
                                                    [7.1, 28.2],
                                                    [5.3, 26.7],
                                                    [3.8, 24.9],
                                                    [2.5, 22.9],
                                                    [1.6, 20.7],
                                                    [1.1, 18.4],
                                                    [0.9, 16],
                                                    [1.1, 13.6],
                                                    [1.6, 11.3],
                                                    [2.5, 9.1],
                                                    [3.8, 7.1],
                                                    [5.3, 5.3],
                                                    [7.1, 3.8],
                                                    [9.1, 2.5],
                                                    [11.3, 1.6],
                                                    [13.6, 1.1],
                                                    [16, 0.9],
                                                ]
                                            ]
                                        },
                                        "symbol": {
                                            "type": "CIMPolygonSymbol",
                                            "symbolLayers": [
                                                {
                                                    "type": "CIMSolidFill",
                                                    "enable": True,
                                                    "color": [250, 126, 55, 255],
                                                }
                                            ],
                                        },
                                    },
                                    {
                                        "type": "CIMMarkerGraphic",
                                        "geometry": {
                                            "rings": [
                                                [
                                                    [10, 16.9],
                                                    [10.36, 16.93],
                                                    [10.71, 17.03],
                                                    [11.04, 17.18],
                                                    [11.34, 17.39],
                                                    [11.6, 17.64],
                                                    [11.81, 17.94],
                                                    [11.96, 18.27],
                                                    [12.06, 18.62],
                                                    [12.1, 19],
                                                    [12.07, 19.36],
                                                    [11.97, 19.71],
                                                    [11.82, 20.04],
                                                    [11.61, 20.34],
                                                    [11.35, 20.6],
                                                    [11.06, 20.81],
                                                    [10.73, 20.96],
                                                    [10.38, 21.06],
                                                    [10, 21.1],
                                                    [9.64, 21.07],
                                                    [9.29, 20.97],
                                                    [8.96, 20.82],
                                                    [8.66, 20.61],
                                                    [8.4, 20.36],
                                                    [8.19, 20.06],
                                                    [8.04, 19.73],
                                                    [7.94, 19.38],
                                                    [7.9, 19],
                                                    [7.94, 18.59],
                                                    [8.06, 18.2],
                                                    [8.25, 17.83],
                                                    [8.52, 17.52],
                                                    [8.83, 17.25],
                                                    [9.2, 17.06],
                                                    [9.59, 16.94],
                                                    [10, 16.9],
                                                ]
                                            ]
                                        },
                                        "symbol": {
                                            "type": "CIMPolygonSymbol",
                                            "symbolLayers": [
                                                {
                                                    "type": "CIMSolidFill",
                                                    "enable": False,
                                                    "colorLocked": True,
                                                    "color": [250, 126, 55, 255],
                                                }
                                            ],
                                        },
                                    },
                                    {
                                        "type": "CIMMarkerGraphic",
                                        "geometry": {
                                            "rings": [
                                                [
                                                    [22, 16.9],
                                                    [22.36, 16.93],
                                                    [22.71, 17.03],
                                                    [23.04, 17.18],
                                                    [23.34, 17.39],
                                                    [23.6, 17.65],
                                                    [23.81, 17.94],
                                                    [23.96, 18.27],
                                                    [24.06, 18.62],
                                                    [24.1, 19],
                                                    [24.07, 19.36],
                                                    [23.97, 19.71],
                                                    [23.82, 20.04],
                                                    [23.61, 20.34],
                                                    [23.36, 20.6],
                                                    [23.06, 20.81],
                                                    [22.73, 20.96],
                                                    [22.38, 21.06],
                                                    [22, 21.1],
                                                    [21.64, 21.07],
                                                    [21.29, 20.97],
                                                    [20.96, 20.82],
                                                    [20.66, 20.61],
                                                    [20.4, 20.36],
                                                    [20.19, 20.06],
                                                    [20.04, 19.73],
                                                    [19.94, 19.38],
                                                    [19.9, 19],
                                                    [19.93, 18.64],
                                                    [20.03, 18.29],
                                                    [20.18, 17.96],
                                                    [20.39, 17.66],
                                                    [20.64, 17.4],
                                                    [20.94, 17.19],
                                                    [21.27, 17.04],
                                                    [21.62, 16.94],
                                                    [22, 16.9],
                                                ]
                                            ]
                                        },
                                        "symbol": {
                                            "type": "CIMPolygonSymbol",
                                            "symbolLayers": [
                                                {
                                                    "type": "CIMSolidFill",
                                                    "enable": False,
                                                    "colorLocked": True,
                                                    "color": [250, 126, 55, 255],
                                                }
                                            ],
                                        },
                                    },
                                    {
                                        "type": "CIMMarkerGraphic",
                                        "geometry": {
                                            "rings": [
                                                [
                                                    [8.24, 8.27],
                                                    [8.37, 8.16],
                                                    [8.51, 8.08],
                                                    [8.66, 8.02],
                                                    [8.82, 7.99],
                                                    [8.99, 7.98],
                                                    [9.15, 8],
                                                    [9.31, 8.05],
                                                    [9.46, 8.12],
                                                    [9.59, 8.21],
                                                    [9.71, 8.33],
                                                    [10.83, 9.27],
                                                    [12.08, 10.02],
                                                    [13.44, 10.55],
                                                    [14.87, 10.86],
                                                    [16.33, 10.92],
                                                    [17.78, 10.75],
                                                    [19.18, 10.34],
                                                    [20.49, 9.71],
                                                    [21.69, 8.87],
                                                    [22.28, 8.33],
                                                    [22.61, 8.09],
                                                    [23, 8],
                                                    [23.16, 8.01],
                                                    [23.31, 8.05],
                                                    [23.46, 8.1],
                                                    [23.59, 8.19],
                                                    [23.71, 8.29],
                                                    [23.82, 8.42],
                                                    [23.91, 8.57],
                                                    [23.97, 8.74],
                                                    [24, 8.91],
                                                    [24, 9.08],
                                                    [23.97, 9.25],
                                                    [23.91, 9.42],
                                                    [23.82, 9.57],
                                                    [23.71, 9.7],
                                                    [22.35, 10.86],
                                                    [20.81, 11.78],
                                                    [19.15, 12.44],
                                                    [17.39, 12.82],
                                                    [15.6, 12.91],
                                                    [13.83, 12.7],
                                                    [12.1, 12.2],
                                                    [10.49, 11.43],
                                                    [9.02, 10.4],
                                                    [8.3, 9.74],
                                                    [8.07, 9.46],
                                                    [7.96, 9.11],
                                                    [7.97, 8.75],
                                                    [8.12, 8.42],
                                                    [8.24, 8.27],
                                                ]
                                            ]
                                        },
                                        "symbol": {
                                            "type": "CIMPolygonSymbol",
                                            "symbolLayers": [
                                                {
                                                    "type": "CIMSolidFill",
                                                    "enable": False,
                                                    "colorLocked": True,
                                                    "color": [250, 126, 55, 255],
                                                }
                                            ],
                                        },
                                    },
                                ],
                                "scaleSymbolsProportionally": True,
                                "respectFrame": True,
                                "clippingPath": {
                                    "type": "CIMClippingPath",
                                    "clippingType": "Intersect",
                                    "path": {
                                        "rings": [
                                            [[0, 0], [32, 0], [32, 32], [0, 32], [0, 0]]
                                        ]
                                    },
                                },
                                "rotation": 360,
                            },
                        ],
                        "haloSize": 1,
                        "scaleX": 1,
                        "angleAlignment": "Display",
                        "angle": 360,
                    },
                },
            }
        }
